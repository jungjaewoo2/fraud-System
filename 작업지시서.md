# 프라임렌트카 웹사이트 프로젝트 문서

## 프로젝트 개요
- **프로젝트명**: 상품권 부정방지 시스템
- **주요 기능**: 
  - 상품권 부정방지를 위한 이름과 핸드폰 번호 체크
  - 상품권 사용 이력 관리
  - 사용자 페이지는 모바일 기반으로 제작하며,  관리자는 PC형태로 구성해줘

## 기술 스택
### Backend
- **언어**: Java 21
- **웹 프레임워크**: Spring Boot 3.5.4
- **서버**: Apache Tomcat (내장)
- **데이터베이스**: MySQL 8.0
- **빌드 도구**: Maven 3.6+

### Frontend
- **언어**: HTML5, CSS3, JavaScript
- **라이브러리**: Bootstrap 5, JSTL
- **템플릿 엔진**: JSP


## 프로젝트 구조
```
prime_car/
├── src/
│   ├── main/
│   │   ├── java/com/jj/faud_System/
│   │   │   ├── config/              # 설정 클래스 (생성필요)
│   │   │   │   └── SecurityConfig.java
│   │   │   ├── controller/          # 컨트롤러 (생성필요)
│   │   │   ├── entity/              # JPA 엔티티 (생성필요)
│   │   │   ├── repository/          # 데이터 접근 계층 (생성필요)
│   │   │   ├── service/             # 비즈니스 로직 (생성필요)
│   │   │   ├── util/                # 유틸리티 (생성필요)
│   │   │   ├── HomeController.java  # 메인 컨트롤러 (생성필요)
│   │   │   ├── FraudSystemApplication.java # 메인 애플리케이션 클래스
│   │   │   └── ServletInitializer.java
│   │   ├── resources/
│   │   │   ├── application.properties # 애플리케이션 설정
│   │   │   ├── db/init.sql          # 데이터베이스 초기화 스크립트 (생성필요)
│   │   │   └── static/              # 정적 리소스
│   │   └── webapp/
│   │       ├── assets/              # CSS, JS, 이미지 파일 (작업시 필요한 css, fonts, images, js은 생성필요)
│   │       │   ├── css/
│   │       │   ├── fonts/
│   │       │   ├── images/
│   │       │   └── js/
│   │       ├── uploads/             # 업로드된 파일
│   │       └── WEB-INF/views/       # JSP 뷰 템플릿
│   │           ├── admin/           # 관리자 페이지
│   │           ├── *.jsp            # 사용자 페이지
│   │           ├── header.jsp       # 공통 헤더
│   │           └── footer.jsp       # 공통 푸터
│   └── test/
│       └── java/                    # 테스트 코드
├── pom.xml                          # Maven 설정
└── README.md                        # 프로젝트 문서
```

## 주요 기능 및 페이지 구성

### 사용자 페이지
- **메인 로그인 페이지** : 사용자 로그인 (이름, 핸드폰번호 체크)
- **2차 인증**: 사용자가 로그인후 인증받은 관리자가 코드번호(관리자에게 부여되는 코드번호) 입력하는 화면 (코드를 입력함)
               관리자모드에서 코드관리에 등록된 코드번호는 여기서 참고하여 맞으면 다음화면 넘어감  
- **상품권 지급** : 상품권 1만원, 2만원 금액을 선택할수 있는 화면, 관리자가 부여함
- **상품권 사용이력 확인** : 사용자 상품권 사용이력 조회 (사용자에게 지급한 상품권 이력을 지급날짜, 지급담당자, 금액으로 리스트화)
                            지급한 상품권 리스트에서 지급금액을 수정 또는 삭제가 가능하도록 함
                            지급담당자는 관리자모드에서 등록된 코드관리의 코드번호에 맞는 이름을 보이게 처리함 

### 관리자 페이지 (`/admin`)
- **로그인** : 관리자 인증 (아이디/패스워드 입력)
- **비밀번호 변경** : 관리자 패스워드 변경
- **코드관리** : 이름(사람이름), 코드번호를 여러개 등록 가능함, 수정/삭제가 가능함
- **상품권 관리** : 상품권 지급한 사용자의 이름, 핸드폰 번호, 생년월일 리스트화 
                   사용자 삭제시 해당 상품권 내역등도 모두 삭제되도록 함 
                   사용자 리스트에서 클릭시 상세내역에 상품권 지급내역 날짜, 금액을 리스트로  보이게 처리
                   상세내역에서 보이는 상세내역에서 지급내역을 삭제/수정할수 있게 처리함


## 환경 설정

### 1. 개발 환경 설정
- **Java**: JDK 21 이상
- **Maven**: 3.6 이상
- **MySQL**: 8.0 이상
- **IDE**: IntelliJ IDEA 또는 Eclipse

### 2. 데이터베이스 연결 설정
`src/main/resources/application.properties` 파일에서 데이터베이스 연결 정보 설정:

```properties
# 데이터베이스 설정 (현재 faud_System database을 생성해 두었음 )
spring.datasource.url=jdbc:mysql://localhost:3306/faud_System?useSSL=false&serverTimezone=Asia/Seoul&characterEncoding=UTF-8&allowPublicKeyRetrieval=true
spring.datasource.username=root
spring.datasource.password=topy1004
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# JPA 설정
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
```

### 3. Maven 의존성 (pom.xml)
주요 의존성:
- Spring Boot Starter Web
- Spring Boot Starter Data JPA
- Spring Boot Starter Security
- Spring Boot Starter Tomcat
- MySQL Connector Java
- Tomcat Embed Jasper (JSP 지원)
- Jakarta Servlet JSP JSTL
- Apache HttpClient

## 핵심 클래스 및 메서드

### 1. 데이터베이스 연결 클래스
- **FaudApplication.java**: 메인 애플리케이션 클래스, JSP 뷰 리졸버 설정
- **SecurityConfig.java**: Spring Security 설정
- **CustomUserDetailsService.java**: 사용자 인증 서비스

### 2. 주요 컨트롤러 메서드

#### HomeController.java
- 메인 로그인 페이지
- 관리자 코드 인증
- 상품권 사용이력 및 관리: 상품권 사용이력 및 수정삭제

#### AdminController.java
- 로그인
- 코드번호 관리 (관리자이름, 코드번호) 
- 상품권 사용 이력


## 배포 및 운영

### 1. 빌드 명령어
```bash
# Maven 빌드
mvn clean compile
mvn package

# 애플리케이션 실행
mvn spring-boot:run


### 2. 서버 설정
- **포트**: 8080 (기본값)
- **컨텍스트 경로**: `/`
- **로그 파일**: `prime.log`
- **파일 업로드**: 최대 10MB

### 3. 접속 정보
- **사용자 페이지**: http://localhost:8080
- **관리자 페이지**: http://localhost:8080/admin/login
- **기본 관리자 계정**: admin / 123

### 자주 발생하는 문제들 작업시 유의
1. **데이터베이스 연결 오류**: MySQL 서버 상태 및 연결 정보 확인
2. **JSP 페이지 로딩 오류**: Tomcat Embed Jasper 의존성 확인


